1. Balance of Bivek rai
SELECT SUB_CODE, SUB_EDESC AS CUSTOMER_NAME, SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0))  AS BALANCE FROM AI_LEDGER_REPORT WHERE SUB_EDESC like '%BIVEK RAI%' AND DELETED_FLAG = 'N' GROUP BY SUB_CODE, SUB_EDESC;

2. Detailed balance of Bivek rai
SELECT CASE WHEN GROUPING(VOUCHER_NO) = 1 THEN 'Grand Total' ELSE TO_CHAR(MIN(VOUCHER_DATE), 'YYYY-MM-DD') END AS VOUCHER_DATE, SUM(DR_AMOUNT) AS DR_AMOUNT, SUM(CR_AMOUNT) AS CR_AMOUNT, SUM(DR_AMOUNT) - SUM(CR_AMOUNT) AS BALANCE FROM AI_LEDGER_REPORT WHERE SUB_EDESC LIKE '%BIVEK RAI%' AND DELETED_FLAG = 'N' GROUP BY ROLLUP(VOUCHER_NO) ORDER BY VOUCHER_DATE;

3. Balance of customer prisma advertising
SELECT 
    SUB_EDESC AS CUSTOMER_NAME, 
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0))  AS BALANCE
FROM 
    AI_LEDGER_REPORT
WHERE 
    SUB_EDESC like '%PRISMA ADVERTISING PVT. LTD.%'
    AND DELETED_FLAG = 'N'
    AND SUB_LEDGER_FLAG = 'C'
GROUP BY 
    SUB_CODE, SUB_EDESC;


4. Balance of supplier prisma advertising 

SELECT 
    SUB_EDESC AS CUSTOMER_NAME, 
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0))  AS BALANCE
FROM 
    AI_LEDGER_REPORT
WHERE 
    SUB_EDESC like '%PRISMA ADVERTISING PVT. LTD.%'
    AND DELETED_FLAG = 'N'
    AND SUB_LEDGER_FLAG = 'S'
GROUP BY 
    SUB_CODE, SUB_EDESC;




5. cash balance :
SELECT 
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0)) AS "Cash Balance"
FROM 
    AI_GENERAL_LEDGER
WHERE 
    ACC_NATURE = 'AB' 
    AND DELETED_FLAG = 'N' 


6. BRANCH WISE CASH BALANCE
SELECT BRANCH_EDESC AS Branch,
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0)) AS "Cash Balance"
FROM 
    AI_GENERAL_LEDGER
WHERE 
    ACC_NATURE = 'AB' 
    AND DELETED_FLAG = 'N' 
GROUP BY 
BRANCH_EDESC
ORDER BY 2 DESC;


7. Total Bank balance
SELECT
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0)) AS "Bank Balance"
FROM 
    AI_GENERAL_LEDGER
WHERE 
    ACC_NATURE = 'AC' 
    AND DELETED_FLAG = 'N' 


8. Detailed bank balance
SELECT 
    ACC_EDESC AS "Bank Name",
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0)) AS "Bank Balance"
FROM 
    AI_GENERAL_LEDGER
WHERE 
    ACC_NATURE = 'AC' 
    AND DELETED_FLAG = 'N'
GROUP BY 
    ACC_EDESC
ORDER BY 2 DESC;





SELECT 
    ACC_EDESC AS "Ledger Description",
    SUM(nvl(DR_AMOUNT,0)) - SUM(nvl(CR_AMOUNT,0)) AS "Amount"
FROM 
    V$VIRTUAL_GENERAL_LEDGER
WHERE 
   ACC_NATURE = 'AE' 
    and DELETED_FLAG = 'N'
GROUP BY 
    ACC_EDESC
ORDER BY 2 DESC;